<!DOCTYPE html SYSTEM "about:legacy-compat">
<html>
      <head>
        <meta charset="utf-8"/>
        <meta content="width=device-width, initial-scale=1" name="viewport"/>
        <title>sbt Reference Manual — Track file inputs and outputs</title>
        <link rel="shortcut icon" href="favicon.ico"/>
        <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css"/>
        <link rel="stylesheet" href="css/pamflet.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/pamflet-print.css" type="text/css" media="print"/>
        <link rel="stylesheet" href="css/pamflet-grid.css" type="text/css" media="screen and (min-device-width: 800px), projection"/>
        <link rel="stylesheet" href="css/color_scheme-redmond.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/color_scheme-github.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/color_scheme-monokai.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/pamfletheight_80px_2em.css" type="text/css" media="screen and (min-device-width: 800px), projection"/>
        <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
        <script type="text/javascript" src="js/bootstrap.bundle.min.js"></script>
        <script type="text/javascript" src="js/pamflet.js"></script>
        <script type="text/javascript">
          Pamflet.page.language = 'en';
        </script>
        <script type="text/javascript" src="js/prettify/prettify.js"></script><script type="text/javascript" src="js/prettify/lang-scala.js"></script><link type="text/css" rel="stylesheet" href="css/prettify.css"/><script type="text/javascript"><!--
        window.onload=function() { prettyPrint(); };
      --></script>
        <link rel="stylesheet" href="css/custom.css" type="text/css" media="screen, projection"/><link rel="stylesheet" href="css/custom-202107.css" type="text/css" media="screen, projection"/>
        
        <script type="text/javascript">
              Pamflet.twitter = '#sbt #scala';
            </script>
      </head>
      <body class="color_scheme-github">
        <div class="container-fluid contentswrapper h-100">
          <div class="row minh-100">
          <div class="col-md-4 col-xl-3 toccolumn leftcolumn">
                  <div class="lefttocwrapper">
      <div class="tocwrapper">
        
        <div class="tocbody show" id="toc">
        
        <div><a href="index.html">sbt Reference Manual</a></div><ol class="toc"> <li><div><a href="Getting-Started.html">Getting Started with sbt</a></div><ol class="toc"> <li><div><a href="Setup.html">Installing sbt</a></div><ol class="toc"> <li><div><a href="Installing-sbt-on-Mac.html">Installing sbt on macOS</a></div></li><li><div><a href="Installing-sbt-on-Windows.html">Installing sbt on Windows</a></div></li><li><div><a href="Installing-sbt-on-Linux.html">Installing sbt on Linux</a></div></li> </ol></li><li><div><a href="sbt-by-example.html">sbt by example</a></div></li><li><div><a href="Directories.html">Directory structure</a></div></li><li><div><a href="Running.html">Running</a></div></li><li><div><a href="Basic-Def.html">Build definition</a></div></li><li><div><a href="Multi-Project.html">Multi-project builds</a></div></li><li><div><a href="Task-Graph.html">Task graph</a></div></li><li><div><a href="Scopes.html">Scopes</a></div></li><li><div><a href="Appending-Values.html">Appending values</a></div></li><li><div><a href="Scope-Delegation.html">Scope delegation (.value lookup)</a></div></li><li><div><a href="Library-Dependencies.html">Library dependencies</a></div></li><li><div><a href="Using-Plugins.html">Using plugins</a></div></li><li><div><a href="Custom-Settings.html">Custom settings and tasks</a></div></li><li><div><a href="Organizing-Build.html">Organizing the build</a></div></li><li><div><a href="Summary.html">Getting Started summary</a></div></li> </ol></li><li><div><a href="Faq.html">Frequently Asked Questions</a></div><ol class="toc">  </ol></li><li><div><a href="General-Info.html">General Information</a></div><ol class="toc"> <li><div><a href="Credits.html">Credits</a></div></li><li><div><a href="Community-Plugins.html">Community Plugins</a></div></li><li><div><a href="Repository-Roles.html">Community Repository Policy</a></div></li><li><div><a href="Bintray-For-Plugins.html">Bintray For Plugins</a></div></li><li><div><a href="Setup-Notes.html">Setup Notes</a></div></li><li><div><a href="Using-Sonatype.html">Using Sonatype</a></div></li><li><div><a href="Contributing-to-sbt.html">Contributing to sbt</a></div></li><li><div><a href="Changes.html">Changes</a></div><ol class="toc"> <li><div><a href="Migrating-from-sbt-013x.html">Migrating from sbt 0.13.x</a></div></li><li><div><a href="sbt-1.4-Release-Notes.html">sbt 1.4.x releases</a></div></li><li><div><a href="sbt-1.3-Release-Notes.html">sbt 1.3.x releases</a></div></li><li><div><a href="sbt-1.2-Release-Notes.html">sbt 1.2.x releases</a></div></li><li><div><a href="sbt-1.1-Release-Notes.html">sbt 1.1.x releases</a></div></li><li><div><a href="sbt-1.0-Release-Notes.html">sbt 1.0.x releases</a></div></li> </ol></li> </ol></li><li><div><a href="Detailed-Topics.html">Detailed Topics</a></div><ol class="toc"> <li><div><a href="Using-sbt.html">Using sbt</a></div><ol class="toc"> <li><div><a href="Command-Line-Reference.html">Command Line Reference</a></div></li><li><div><a href="Console-Project.html">Console Project</a></div></li><li><div><a href="Cross-Build.html">Cross-building</a></div></li><li><div><a href="Inspecting-Settings.html">Interacting with the Configuration System</a></div></li><li><div><a href="Triggered-Execution.html">Triggered Execution</a></div></li><li><div><a href="Scripts.html">Scripts, REPL, and Dependencies</a></div></li><li><div><a href="sbt-server.html">sbt Server</a></div></li><li><div><a href="Understanding-Recompilation.html">Understanding Incremental Recompilation</a></div></li> </ol></li><li><div><a href="Configuration-Index.html">Configuration</a></div><ol class="toc"> <li><div><a href="Classpaths.html">Classpaths, sources, and resources</a></div></li><li><div><a href="Compiler-Plugins.html">Compiler Plugin Support</a></div></li><li><div><a href="Configuring-Scala.html">Configuring Scala</a></div></li><li><div><a href="Forking.html">Forking</a></div></li><li><div><a href="Global-Settings.html">Global Settings</a></div></li><li><div><a href="Java-Sources.html">Java Sources</a></div></li><li><div><a href="Mapping-Files.html">Mapping Files</a></div></li><li><div><a href="Local-Scala.html">Local Scala</a></div></li><li><div><a href="Macro-Projects.html">Macro Projects</a></div></li><li><div><a href="Paths.html">Paths</a></div></li><li><div><a href="Parallel-Execution.html">Parallel Execution</a></div></li><li><div><a href="Process.html">External Processes</a></div></li><li><div><a href="Running-Project-Code.html">Running Project Code</a></div></li><li><div><a href="Testing.html">Testing</a></div></li><li><div><a href="In-Process-Classloaders.html">In process class loading</a></div></li><li><div><a href="Globs.html">Globs</a></div></li><li><div><a href="Remote-Caching.html">Remote Caching</a></div></li> </ol></li><li><div><a href="Dependency-Management-Index.html">Dependency Management</a></div><ol class="toc"> <li><div><a href="Artifacts.html">Artifacts</a></div></li><li><div><a href="Dependency-Management-Flow.html">Dependency Management Flow</a></div></li><li><div><a href="Library-Management.html">Library Management</a></div></li><li><div><a href="Proxy-Repositories.html">Proxy Repositories</a></div></li><li><div><a href="Publishing.html">Publishing</a></div></li><li><div><a href="Resolvers.html">Resolvers</a></div></li><li><div><a href="Update-Report.html">Update Report</a></div></li><li><div><a href="Cached-Resolution.html">Cached Resolution</a></div></li> </ol></li><li><div><a href="Tasks-and-Commands.html">Tasks and Commands</a></div><ol class="toc"> <li><div><a href="Tasks.html">Tasks</a></div></li><li><div><a href="Caching.html">Caching</a></div></li><li><div><a href="Input-Tasks.html">Input Tasks</a></div></li><li><div><a href="Commands.html">Commands</a></div></li><li><div><a href="Parsing-Input.html">Parsing and tab completion</a></div></li><li><div><a href="Build-State.html">State and actions</a></div></li><li><div><a href="Task-Inputs.html">Tasks/Settings: Motivation</a></div></li> </ol></li><li><div><a href="Plugins-and-Best-Practices.html">Plugins and Best Practices</a></div><ol class="toc"> <li><div><a href="Best-Practices.html">General Best Practices</a></div></li><li><div><a href="Plugins.html">Plugins</a></div></li><li><div><a href="Plugins-Best-Practices.html">Plugins Best Practices</a></div></li><li><div><a href="GitHub-Actions-with-sbt.html">Setting up GitHub Actions with sbt</a></div></li><li><div><a href="Travis-CI-with-sbt.html">Setting up Travis CI with sbt</a></div></li><li><div><a href="Testing-sbt-plugins.html">Testing sbt plugins</a></div></li><li><div><a href="sbt-new-and-Templates.html">sbt new and Templates</a></div></li><li><div><a href="Cross-Build-Plugins.html">Cross building plugins</a></div></li> </ol></li> </ol></li><li><div><a href="Howto.html">How to…</a></div><ol class="toc"> <li><div><a href="Howto-Classpaths.html">Classpaths</a></div></li><li><div><a href="Howto-Customizing-Paths.html">Customizing paths</a></div></li><li><div><a href="Howto-Generating-Files.html">Generating files</a></div></li><li><div><a href="Howto-Inspect-the-Build.html">Inspect the build</a></div></li><li><div><a href="Howto-Interactive-Mode.html">Interactive mode</a></div></li><li><div><a href="Howto-Logging.html">Configure and use logging</a></div></li><li><div><a href="Howto-Project-Metadata.html">Project metadata</a></div></li><li><div><a href="Howto-Package.html">Configure packaging</a></div></li><li><div><a href="Howto-Running-Commands.html">Running commands</a></div></li><li><div><a href="Howto-Scala.html">Configure and use Scala</a></div></li><li><div><a href="Howto-Scaladoc.html">Generate API documentation</a></div></li><li><div><a href="Define+Custom+Tasks.html">Define Custom Tasks</a></div></li><li><div><a href="Howto-Startup.html">How to take an action on startup</a></div></li><li><div class="current">Track file inputs and outputs</div></li><li><div><a href="Troubleshoot-Memory-Issues.html">Troubleshoot memory issues</a></div></li><li><div><a href="Howto-Sequencing.html">Sequencing</a></div><ol class="toc"> <li><div><a href="Howto-Sequential-Task.html">Defining a sequential task with Def.sequential</a></div></li><li><div><a href="Howto-Dynamic-Task.html">Defining a dynamic task with Def.taskDyn</a></div></li><li><div><a href="Howto-After-Input-Task.html">Doing something after an input task</a></div></li><li><div><a href="Howto-Dynamic-Input-Task.html">Defining a dynamic input task with Def.inputTaskDyn</a></div></li><li><div><a href="Howto-Sequence-using-Commands.html">How to sequence using commands</a></div></li> </ol></li><li><div><a href="Custom-Dependency-Configuration.html">How to define a custom dependency configuration</a></div></li><li><div><a href="Examples.html">Examples</a></div><ol class="toc"> <li><div><a href="Basic-Def-Examples.html">.sbt build examples</a></div></li><li><div><a href="Scala-Files-Example.html">.sbt build with .scala files example</a></div></li><li><div><a href="Advanced-Configurations-Example.html">Advanced configurations example</a></div></li><li><div><a href="Advanced-Command-Example.html">Advanced command example</a></div></li> </ol></li> </ol></li><li><div><a href="Name-Index.html">Index</a></div></li><li><div><a href="Developers-Guide.html">Developer’s Guide (Work in progress)</a></div><ol class="toc"> <li><div><a href="Modularization.html">Modularization</a></div><ol class="toc"> <li><div><a href="Module-Summary.html">Module summary</a></div></li> </ol></li><li><div><a href="Coding-Guideline.html">sbt Coding Guideline</a></div><ol class="toc">  </ol></li><li><div><a href="Datatype.html">sbt-datatype</a></div><ol class="toc">  </ol></li><li><div><a href="Compiler-Interface.html">Compiler Interface</a></div><ol class="toc"> <li><div><a href="Version-Specific-Sources.html">Fetching the most specific sources</a></div></li> </ol></li><li><div><a href="Sbt-Launcher.html">sbt Launcher</a></div><ol class="toc"> <li><div><a href="Launcher-Getting-Started.html">Getting Started with the sbt launcher</a></div></li><li><div><a href="Launcher-Architecture.html">Sbt Launcher Architecture</a></div></li><li><div><a href="Launcher-Configuration.html">sbt Launcher Configuration</a></div></li> </ol></li><li><div><a href="DevGuide-Notes.html">Notes</a></div><ol class="toc"> <li><div><a href="Core-Principles.html">Core Principles</a></div></li><li><div><a href="Settings-Core.html">Settings Core</a></div></li><li><div><a href="Setting-Initialization.html">Setting Initialization</a></div></li><li><div><a href="Command-Line-Applications.html">Creating Command Line Applications Using sbt</a></div></li> </ol></li> </ol></li><li><div><a href="Archived+pages.html">Archived pages</a></div><ol class="toc"> <li><div><a href="Hello.html">Hello, World</a></div></li> </ol></li><li class="generated"><div><a href="Contents+in+Depth.html">Contents in Depth</a></div></li><li class="generated"><div><a href="Combined+Pages.html">Combined Pages</a></div></li> </ol></div>
      </div>
      </div>
                </div><div class="col-md-8 col-xs-9">
                  <div class="rightcolumn contents">
                  <h2 id="Track+file+inputs+and+outputs">Track file inputs and outputs<a href="#Track+file+inputs+and+outputs" class="header-link"><span class="header-link-content">&nbsp;</span></a></h2><p>Many sbt tasks depend on a collection of files. For example, the
<code>package</code> task generates a jar file containing the resources and class files,
which are generated by the <code>compile</code> task, for a project. Staring with version
1.3.0, sbt provides a file management system that tracks the inputs and outputs
of any task. The task can query which of its file dependencies have changed
since the task last completed allowing it to incrementally re-build only the
modified files. This system integrates with <a href="Triggered-Execution.html">Triggered
execution</a> so that the file dependencies of a task are
automatically monitored in a continuous build.
</p><p>To best illustrate the file tracking system, we construct a build.sbt that
illustrates all of the essential features. The example will be a project that is
able to build a shared library in c using gcc. This will be done with two tasks:
<code>buildObjects</code>, which compiles c source files to object files, and
<code>linkLibrary</code>, which links the object files into a shared library. These can be
defined with:
</p><pre><code class="prettyprint lang-scala">import java.nio.file.Path
val buildObjects = taskKey[Seq[Path]](&quot;Compiles c files into object files.&quot;)
val linkLibrary = taskKey[Path](&quot;Links objects into a shared library.&quot;)
</code></pre><p>The <code>buildObjects</code> task will depend on <code>*.c</code> source file inputs. The <code>linkLibrary</code>
task depends on the output <code>*.o</code> object files generated by <code>buildObjects</code>. This
creates a build pipeline: if none of the input sources to <code>buildObjects</code> are
modified between calls to <code>linkLibrary</code> then neither compilation nor linking
should occur. Conversely, when input source changes are detected, sbt should
both generate new object files corresponding to the modified source files and
link the shared library.
</p><h3 id="File+inputs">File inputs<a href="#File+inputs" class="header-link"><span class="header-link-content">&nbsp;</span></a></h3><p>It is natural for a task to specify the inputs on which it depends. These are
set with the <code>fileInputs</code> key, which has type: <code>Seq[Glob]</code> (see <a href="Globs.html">Globs</a>).
The <code>fileInputs</code> are specified as <code>Seq[Glob]</code> so that more than one search query
may be provided, which may be necessary if sources are located in multiple
directories or different file types are needed within the same task.
</p><p>When the <code>fileInputs</code> key is set in a given scope, sbt automatically generates
a task named <code>allInputFiles</code> for that scope that returns a <code>Seq[Path]</code>
containing all of the files matching the <code>fileInputs</code> queries. For convenience,
there is an extension method defined for <code>Task[_]</code> that translates
<code>foo.inputFiles</code> to <code>(foo / allInputFiles).value</code>. We can use these to write a
simple implementation of <code>buildObjects</code>:
</p><pre><code class="prettyprint lang-scala">import scala.sys.process._
import java.nio.file.{ Files, Path }
import sbt.nio._
import sbt.nio.Keys._

val buildObjects = taskKey[Seq[Path]](&quot;Compiles c files into object files.&quot;)
buildObjects / fileInputs += baseDirectory.value.toGlob / &quot;src&quot; / &quot;*.c&quot;
buildObjects := {
  val outputDir = Files.createDirectories(streams.value.cacheDirectory.toPath)
  def outputPath(path: Path): Path =
    outputDir / path.getFileName.toString.replaceAll(&quot;.c$&quot;, &quot;.o&quot;)
  val logger = streams.value.log
  buildObjects.inputFiles.map { path =&gt;
    val output = outputPath(path)
    logger.info(s&quot;Compiling $path to $output&quot;)
    Seq(&quot;gcc&quot;, &quot;-c&quot;, path.toString, &quot;-o&quot;, output.toString).!!
    output
  }
}
</code></pre><p>This implementation will gather all of the files ending with the <code>*.c</code> extension
and shell out to gcc to compile them to the output directory.
</p><p>sbt will automatically monitor any file matched by the globs specified by
<code>fileInputs</code>. In this
case, modifying any file with <code>*.c</code> extension in the <code>src</code> directory will trigger
a build in a continuous build.
</p><h4 id="Incremental+builds">Incremental builds<a href="#Incremental+builds" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>Every time that <code>buildObjects</code> is invoked from the sbt shell, it will re-compile
all of the source files. This becomes expensive as the number of source files
increases. In addition to <code>fileInputs</code>, sbt also provides another api,
<code>inputFileChanges</code>, that provides information about what source files have changed
since the last time the task successfully completed. Using the
<code>inputFileChanges</code>, we can make the build above incremental:
</p><pre><code class="prettyprint lang-scala">import scala.sys.process._
import java.nio.file.{ Files, Path }
import sbt.nio._
import sbt.nio.Keys._

val buildObjects = taskKey[Seq[Path]](&quot;Generate object files from c sources&quot;)
buildObjects / fileInputs += baseDirectory.value.toGlob / &quot;src&quot; / &quot;*.c&quot;
buildObjects := {
  val outputDir = Files.createDirectories(streams.value.cacheDirectory.toPath)
  val logger = streams.value.log
  def outputPath(path: Path): Path =
    outputDir / path.getFileName.toString.replaceAll(&quot;.c$&quot;, &quot;.o&quot;)
  def compile(path: Path): Path = {
    val output = outputPath(path)
    logger.info(s&quot;Compiling $path to $output&quot;)
    Seq(&quot;gcc&quot;, &quot;-fPIC&quot;, &quot;-std=gnu99&quot;, &quot;-c&quot;, s&quot;$path&quot;, &quot;-o&quot;, s&quot;$output&quot;).!!
    output
  }
  val sourceMap = buildObjects.inputFiles.view.map(p =&gt; outputPath(p) -&gt; p).toMap
  val existingTargets = fileTreeView.value.list(outputDir.toGlob / **).flatMap { case (p, _) =&gt;
    if (!sourceMap.contains(p)) {
      Files.deleteIfExists(p)
      None
    } else {
      Some(p)
    }
  }.toSet
  val changes = buildObjects.inputFileChanges
  val updatedPaths = (changes.created ++ changes.modified).toSet
  val needCompile = updatedPaths ++ sourceMap.filterKeys(!existingTargets(_)).values
  needCompile.foreach(compile)
  sourceMap.keys.toVector
}
</code></pre><p>The <code>FileChangeReport</code> makes it possible to write an incremental task without
manually tracking the input files. It is a sealed trait implemented by three case classes:
</p><ol><li><code>Changes</code> — indicates that one or more source files have been modified.
</li><li><code>Unmodified</code> — none of the source file have been modified since the last
run.
</li><li><code>Fresh</code> — there is no cache entry for the previous source file hashes.
</li></ol><p>It is sometimes convenient to pattern match on the result of the
<code>inputFileChanges</code>:
</p><pre><code class="prettyprint lang-scala">foo.inputFileChanges match {
  case FileChanges(created, deleted, modified, unmodified)
    if created.nonEmpty || modified.nonEmpty =&gt;
      build(created ++ modified)
      delete(deleted)
  case _ =&gt; // no changes
}
</code></pre><p>The input file report says nothing about the outputs. This is why the
<code>buildObjects</code> implementation needs to check the target directory to see which
outputs exist. In that example, there is a 1:1 mapping between inputs and
outputs, but this need not be the case in general. An implementation of <code>buildObjects</code> may include header files in the <code>fileInputs</code>. These are not compiled themselves, but they may
trigger re-compilation of one or more <code>*.c</code> source files.
</p><p>Note that calling <code>buildObjects.inputFileChanges</code> also causes <code>buildObjects /
fileInputs</code> to automatically be watched in a continuous build.
</p><h3 id="File+outputs">File outputs<a href="#File+outputs" class="header-link"><span class="header-link-content">&nbsp;</span></a></h3><p>The outputs of a file are often best specified as the result of a task. In the
example above, <code>buildObjects</code> is a <code>Task</code> returning a <code>Seq[Path]</code> containing the
object files generated by compilation. sbt will automatically track the outputs
of any task that returns one of the following result types: <code>Path</code>, <code>Seq[Path]</code>,
<code>File</code> or <code>Seq[File]</code>. We can use this to build on the <code>buildObjects</code> example to
write a task that links the object into a shared library:
</p><pre><code class="prettyprint lang-scala">val linkLibrary = taskKey[Path](&quot;Links objects into a shared library.&quot;)
linkLibrary := {
  val outputDir = Files.createDirectories(streams.value.cacheDirectory.toPath)
  val logger = streams.value.log
  val isMac = scala.util.Properties.isMac
  val library = outputDir / s&quot;mylib.${if (isMac) &quot;dylib&quot; else &quot;so&quot;}&quot;
  val linkOpts = if (isMac) Seq(&quot;-dynamiclib&quot;) else Seq(&quot;-shared&quot;, &quot;-fPIC&quot;)
  if (buildObjects.outputFileChanges.hasChanges || !Files.exists(library)) {
    logger.info(s&quot;Linking $library&quot;)
    (Seq(&quot;gcc&quot;) ++ linkOpts ++ Seq(&quot;-o&quot;, s&quot;$library&quot;) ++
      buildObjects.outputFiles.map(_.toString)).!!
  } else {
    logger.debug(s&quot;Skipping linking of $library&quot;)
  }
  library
}
</code></pre><p>Here the tracking was simpler because linking a shared library is not
incremental. Thus we have to rebuild if any of the outputs of <code>buildObjects</code> has
changed or if the library doesn’t exist.
</p><p>Similar to <code>fileInputs</code>, there is a <code>fileOutputs</code> key. This can be used as an
alternative to returning the output files in the task when the outputs have a
known pattern. For example, <code>buildObjects</code> could have been defined as:
</p><pre><code class="prettyprint lang-scala">val buildObjects = taskKey[Unit](&quot;Compiles c files into object files.&quot;)
buildObjects / fileOutputs := target.value / &quot;objects&quot; / ** / &quot;*.o&quot;
</code></pre><p>This can be useful when using an opaque external tool where the mapping of
inputs to outputs is not known.
</p><p>Like <code>allInputFiles</code>, there is an <code>allOutputFiles</code> task of return type
<code>Seq[Path]</code> that is automatically
generated for a task, <code>foo</code>, if the return type of <code>foo</code> is one of <code>Seq[Path]</code>,
<code>Path</code>, <code>Seq[File]</code> or <code>File</code>. It is also generated if <code>foo / outputFiles</code> is
specified. When both <code>fileOutputs</code> is specified and the return type represents a
file or collection of files, the result of <code>allOutputFiles</code> is the distinct
union of the files returned by the task and the files described by <code>ouputFiles</code>.
Calling <code>foo.outputFiles</code> is syntactic sugar for <code>(foo / allOutputFiles).value</code>.
</p><h3 id="Filters">Filters<a href="#Filters" class="header-link"><span class="header-link-content">&nbsp;</span></a></h3><p>The <code>fileInputs</code> and <code>fileOutputs</code> can be filtered beyond what is specified by
their <code>Glob</code> patterns. sbt provides four settings of type
<a href="Globs.html#path-filters">sbt.nio.file.PathFilter</a>:
1. <code>fileInputIncludeFilter</code> — only include file inputs that also match this
filter
2. <code>fileInputExcludeFilter</code>— exclude any file inputs that also match this filter
3. <code>fileOutputIncludeFilter</code> — only include file inputs that also match this
filter
4. <code>fileOutputExcludeFilter</code> — exclude any file output that also match this filter
</p><p>By default, sbt sets
<code>`scala
fileInputExcludeFilter := HiddenFileFilter.toNio || DirectoryFilter
</code><code>
Both </code>fileInputIncludeFilter<code> and </code>fileInputOutputFilter<code> are set to
</code>AllPassFilter.toNio<code>. The </code>fileOutputExcludeFilter<code> is set to
</code>NothingFilter.toNio`.
</p><p>To exclude files matching with test in the name from <code>buildObjects</code>, write:
</p><pre><code class="prettyprint lang-scala">buildObjects / fileInputExcludeFilter := &quot;*test*&quot;
</code></pre><p>To preserve the previous excludes of hidden files and directories, write:
</p><pre><code class="prettyprint lang-scala">buildObjects / fileInputExcludeFilter :=
  (buildObjects / fileInputExcludeFilter).value || &quot;*test*&quot;
</code></pre><p>or
</p><pre><code class="prettyprint lang-scala">buildObjects / fileInputExcludeFilter ~= { ef =&gt; ef || &quot;*test*&quot; }
</code></pre><p>In most cases, it shouldn’t be necessary to set the <code>fileInputIncludeFilter</code>
since the path name filtering it should be handled by <code>fileInputs</code> itself. It
also shouldn’t commonly be necessary to filter the outputs.
</p><h4 id="Cleaning+outputs">Cleaning outputs<a href="#Cleaning+outputs" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>sbt automatically generates an implementation of <code>clean</code> scoped to the task
<code>foo</code> whenever it also generates the <code>allOutputFiles</code> task. Calling <code>foo /
clean</code> will remove all of the files <em>previously</em> generated by <code>foo</code>. It will not
re-evaluate <code>foo</code>. For example, calling <code>buildObjects / clean</code> will remove all
of the object files generated by the previous call to <code>buildObjects</code>. The
generated clean tasks are not transitive. Calling <code>linkLibrary / clean</code> will
delete the shared library but will not delete the object files generated by
<code>buildObjects</code>.
</p><h3 id="File+change+tracking">File change tracking<a href="#File+change+tracking" class="header-link"><span class="header-link-content">&nbsp;</span></a></h3><p>For each input or output file tracked by sbt, there is an associated
<code>FileStamp</code>. This can either be the last modified time of the file or a hash. By
default, inputs are tracked using the hash and outputs are tracked using the
last modified time. To change this, set the <code>inputFileStamper</code> or
<code>outputFileStamper</code>:
</p><pre><code class="prettyprint lang-scala">val generateSources = taskKey[Seq[Path]](&quot;Generates source files from json schema.&quot;)
generateSources / fileInputs := baseDirectory.value.toGlob / &quot;schema&quot; / ** / &quot;*.json&quot;
generateSources / outputFileStamper := FileStamper.Hash
</code></pre><h4 id="Continuous+build+file+monitoring">Continuous build file monitoring<a href="#Continuous+build+file+monitoring" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>In a continuous build, <code>~bar</code>, for an arbitrary task, <code>bar</code>, given some task,
<code>foo</code>, any calls to <code>foo.inputFiles</code> and <code>foo.inputFileChanges</code> within <code>bar</code>
will cause all of the globs specified by <code>foo / fileInputs</code> to be monitored in a
continuous build.  Transitive file input dependencies are automatically
monitored. For example, the <code>~linkLibrary</code> continuous build command will monitor
the <code>*.c</code> source files defined for <code>buildObjects</code>.
</p><p>Input files will only trigger a re-build if their hash has changed.  This
behavior can be overridden with:
</p><pre><code class="prettyprint lang-scala">Global / watchForceTriggerOnAnyChange := true
</code></pre><p>Changes to file outputs, which are gathered with either <code>foo.outputFiles</code> or
<code>foo.outputFileChanges</code>, do not trigger a re-build.
</p><h4 id="Partial+pipeline+evaluation+%2F+error+handling">Partial pipeline evaluation / error handling<a href="#Partial+pipeline+evaluation+%2F+error+handling" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>The stamps for each file are tracked on a per-task basis. They are only updated
if the incremental task itself succeeds. In the example above, this means that
the current file last modified times for <code>buildObjects</code> are stored by the <code>linkLibrary</code>
task only when it succeeds. This means that <code>buildObjects</code> can be run many times
between calls to <code>linkLibrary</code> and <code>linkLibrary</code> will see the cumulative changes
to the outputs of <code>buildObjects</code>.
</p><p>If <code>linkLibrary</code> fails to complete, sbt will also skip updating the last
modified times for the outputs of <code>buildObjects</code> corresponding to <code>linkLibrary</code>
because it is impossible to know in general which files were successfully
processed.
</p><div class="bottom nav">
                <div class="row">
                  <div class="col-md-auto">
                    <a href="Troubleshoot-Memory-Issues.html">
                      <div class="arrowitem">
                        <span class="arrow">&gt;</span>
                      </div>

                      <div class="arrowitem">
                        <em>Next page</em><br/>
                        Troubleshoot memory issues
                      </div>

                    </a>
                  </div>
                </div>
                <div class="row w-100">
        <div class="col-md-auto ml-auto">
          <ul class="language-bar">
            
          </ul>
        </div>
      </div>
              </div>
                  </div>
                </div>
          </div> <!-- row -->
        </div>
        <div class="header">
          <link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700,900,400italic,700italic" rel="stylesheet" type="text/css">
<!-- Algolia stylesheet -->
<link href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" rel="stylesheet" type = "text/css">
<div class="container-fluid top nav">
  <div class="row w-100">
    <div class="col-md-4">
      <div class="logo">
        <a href="../../index.html"><img src="files/sbt-logo.svg" alt="sbt"></a>
        <span class="versions"><select id="versions"></select></span>
      </div>
    </div>
    <div class="col-md-8">
        <div class="docsearch">
          <input type="text" id="doc-search-bar" placeholder="Search...">
          <ul class="result-container" id="result-container" style="display: none;"></ul>
        </div>
        <div class="nav" id="topbar">
          <a href="../../learn.html">Learn</a>
          <a href="../../download.html">Download</a>
          <a href="../../support.html">Support</a>
          <a href="../../community.html">Get Involved</a>
          <a id="source-code" href="https://github.com/sbt/sbt"><img src="files/github-logo-teal.svg" alt="Source code" class="social"></a>
          <a id="twitter" href="https://twitter.com/scala_sbt"><img src="files/twitter-logo-teal.svg" alt="sbt on Twitter" class="social"></a>
          <a id="edit-on-github" href="https://github.com/sbt/website/edit/develop/src/reference/04-Howto/15-Howto-Track-File-Inputs-and-Outputs.md"><img src="files/octicon-pencil.svg" alt="Edit on GitHub"></a>
        </div>
    </div>
  </div>
</div>
<script type="text/javascript" async>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-41449189-1', 'scala-sbt.org');
ga('send', 'pageview');
</script>
<script type="text/javascript" async>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-23127719-1', 'lightbend.com', {'allowLinker': true, 'name': 'tsTracker'});
  ga('tsTracker.require', 'linker');
  ga('tsTracker.linker:autoLink', ['lightbend.com','playframework.com','scala-lang.org','scaladays.org','spray.io','akka.io','scala-sbt.org']);
  ga('tsTracker.send', 'pageview');
</script>
<script type="text/javascript">
$(function() {
var scrollDown = function() {
if (window.location.hash !== "") {
  setTimeout(function() { $(window).scrollTop($(window).scrollTop() - 120); }, 100);
}
}
scrollDown();
$(window).bind('hashchange', function() {
scrollDown();
});
});
</script>

        </div>
        <div class="footer">
          <footer>
  <div class="container-fluid footer">
    <div class="row">
      <div class="col-md-8">
        <div class="support-item">
          <div class="support-icon">
            <svg class="svg-icon svg-icon-chat" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 97.5 85.2" enable-background="new 0 0 97.5 85.2"><path stroke="#fff" stroke-width="4.282" stroke-linecap="round" stroke-miterlimit="10" d="M27 29.5h-16.3c-4.7 0-8.6 3.9-8.6 8.6v25.7c0 4.7 3.9 8.6 8.6 8.6h2.7c.8 0 1.5.7 1.5 1.5v7.8c0 1.3 1.6 2 2.5 1l9.5-9.5c.5-.5 1.2-.8 2-.8h20.2c4.7 0 8.6-3.9 8.6-8.6v-7.8" fill="none"/><path fill="#fff" d="M85 0h-40c-6.9 0-12.5 5.6-12.5 12.5v33.4c0 2.2 1.8 4.1 4.1 4.1h29.9c.7 0 1.3.3 1.8.7l10 10c1.6 1.6 4.3.5 4.3-1.8v-6.5c0-1.4 1.1-2.5 2.5-2.5 6.9 0 12.5-5.6 12.5-12.5v-25c-.1-6.8-5.8-12.4-12.6-12.4z"/></svg>
          </div>
          <div class="support-detail">
            <h2>Community Support</h2>
            <a href="https://stackoverflow.com/questions/tagged/sbt">StackOverflow</a>
          </div>
        </div>
        <div class="support-item">
          <div class="support-icon">
            <svg id="lightbend-icon-reverse" class="svg-icon svg-icon-lightbend-reverse" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 302 262"><title>lightbend-icon</title><g id="icon"><path d="M1,195v56a10,10,0,0,0,10,10H291a10,10,0,0,0,10-10V195a557.85,557.85,0,0,1-150,20A557.85,557.85,0,0,1,1,195Z" style="fill:#fff"/><path d="M291,1H11A10,10,0,0,0,1,11V176a539.94,539.94,0,0,0,150,21,539.94,539.94,0,0,0,150-21V11A10,10,0,0,0,291,1Z" style="fill:#fff"/></g></svg>
          </div>
          <div class="support-detail">
            <h2>Commercial Support</h2>
            <a href="https://www.lightbend.com/services/expert-support">Lightbend Subscription</a>
            <a href="https://www.lightbend.com/services/training">Training</a>
            <a href="https://www.lightbend.com/services/consulting">Consulting</a>
          </div>
        </div>
      </div>
      <div class="col-md-4 text-right ts">
        &copy; 2016-<script>document.write(new Date().getFullYear())</script> Lightbend Inc.
        <a href="https://www.lightbend.com">
          <img src="files/lightbend-reverse.svg" alt="Lightbend, Inc.">
        </a>
      </div>
    </div>
  </div>
</footer><script src="/assets/versions.js"></script><script src="/assets/set-versions.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script type="text/javascript"> docsearch({
  apiKey: 'e47ee877a07ea1c48722f08430d54913',
  indexName: 'scala-sbt',
  inputSelector: '#doc-search-bar',
  debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
        </div>
        
        <div class="highlight-outer">
              <div class="highlight-menu">
                <ul>
                  <li><button id="highlight-button-twitter"><img src="img/twitter-bird-dark-bgs.png"/></button></li>
                </ul>
              </div>
            </div>
      </body>
    </html>