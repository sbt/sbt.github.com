<!DOCTYPE html SYSTEM "about:legacy-compat">
<html>
      <head>
        <meta charset="utf-8"/>
        <meta content="width=device-width, initial-scale=1" name="viewport"/>
        <title>sbt Reference Manual — sbt 1.0.0</title>
        <link rel="shortcut icon" href="../favicon.ico"/>
        <link rel="stylesheet" href="../css/bootstrap.min.css" type="text/css"/>
        <link rel="stylesheet" href="../css/pamflet.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="../css/pamflet-print.css" type="text/css" media="print"/>
        <link rel="stylesheet" href="../css/pamflet-grid.css" type="text/css" media="screen and (min-device-width: 800px), projection"/>
        <link rel="stylesheet" href="../css/color_scheme-redmond.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="../css/color_scheme-github.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="../css/color_scheme-monokai.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="../css/pamfletheight_80px_2em.css" type="text/css" media="screen and (min-device-width: 800px), projection"/>
        <script type="text/javascript" src="../js/jquery-3.3.1.min.js"></script>
        <script type="text/javascript" src="../js/bootstrap.bundle.min.js"></script>
        <script type="text/javascript" src="../js/pamflet.js"></script>
        <script type="text/javascript">
          Pamflet.page.language = 'ja';
        </script>
        <script type="text/javascript" src="../js/prettify/prettify.js"></script><script type="text/javascript" src="../js/prettify/lang-scala.js"></script><link type="text/css" rel="stylesheet" href="../css/prettify.css"/><script type="text/javascript"><!--
        window.onload=function() { prettyPrint(); };
      --></script>
        <link rel="stylesheet" href="../css/custom-202107.css" type="text/css" media="screen, projection"/>
        
        <script type="text/javascript">
              Pamflet.twitter = '#sbt #scala';
            </script>
      </head>
      <body class="color_scheme-github">
        <div class="container-fluid contentswrapper h-100">
          <div class="row minh-100">
          <div class="col-md-4 col-xl-3 toccolumn leftcolumn">
                  <div class="lefttocwrapper">
      <div class="tocwrapper">
        
        <div class="tocbody show" id="toc">
        
        <div><a href="index.html">sbt Reference Manual</a></div><ol class="toc"> <li><div><a href="Getting-Started.html">始める sbt</a></div><ol class="toc"> <li><div><a href="Setup.html">sbt のインストール</a></div><ol class="toc"> <li><div><a href="Installing-sbt-on-Mac.html">macOS への sbt のインストール</a></div></li><li><div><a href="Installing-sbt-on-Windows.html">Windows への sbt のインストール</a></div></li><li><div><a href="Installing-sbt-on-Linux.html">Linux への sbt のインストール</a></div></li> </ol></li><li><div><a href="sbt-by-example.html">例題でみる sbt</a></div></li><li><div><a href="Directories.html">ディレクトリ構造</a></div></li><li><div><a href="Running.html">実行</a></div></li><li><div><a href="IDE.html">IDE との統合</a></div></li><li><div><a href="Basic-Def.html">ビルド定義</a></div></li><li><div><a href="Multi-Project.html">マルチプロジェクト・ビルド</a></div></li><li><div><a href="Task-Graph.html">タスク・グラフ</a></div></li><li><div><a href="Scopes.html">スコープ</a></div></li><li><div><a href="Appending-Values.html">値の追加</a></div></li><li><div><a href="Scope-Delegation.html">スコープ委譲 (.value の照会)</a></div></li><li><div><a href="Library-Dependencies.html">ライブラリ依存性</a></div></li><li><div><a href="Using-Plugins.html">プラグインの使用</a></div></li><li><div><a href="Custom-Settings.html">カスタムセッティングとタスク</a></div></li><li><div><a href="Organizing-Build.html">ビルドの整理</a></div></li><li><div><a href="Summary.html">まとめ</a></div></li><li><div><a href="Bare-Def.html">付録: bare .sbt ビルド定義</a></div></li> </ol></li><li><div><a href="General-Info.html">インフォメーション</a></div><ol class="toc"> <li><div><a href="Changes.html">変更点</a></div><ol class="toc"> <li><div class="current">sbt 1.0.0</div></li> </ol></li> </ol></li><li><div><a href="Detailed-Topics.html">各論</a></div><ol class="toc"> <li><div><a href="Plugins-and-Best-Practices.html">プラグインとベストプラクティス</a></div><ol class="toc"> <li><div><a href="Best-Practices.html">一般的なベストプラクティス</a></div></li><li><div><a href="Testing-sbt-plugins.html">sbt プラグインをテストする</a></div></li> </ol></li> </ol></li><li><div><a href="Howto.html">How to</a></div><ol class="toc"> <li><div><a href="Howto-Generating-Files.html">ソースファイル/リソースファイルの生成</a></div></li><li><div><a href="Howto-Sequencing.html">逐次実行</a></div><ol class="toc"> <li><div><a href="Howto-Sequential-Task.html">Def.sequential を用いて逐次タスクを定義する</a></div></li><li><div><a href="Howto-Dynamic-Task.html">Def.taskDyn を用いて動的タスクを定義する</a></div></li><li><div><a href="Howto-After-Input-Task.html">インプットタスクの後で何かする</a></div></li><li><div><a href="Howto-Dynamic-Input-Task.html">Def.inputTaskDyn を用いた動的インプットタスクの定義</a></div></li><li><div><a href="Howto-Sequence-using-Commands.html">コマンドを用いた逐次実行</a></div></li> </ol></li> </ol></li><li><div><a href="Archived+pages.html">Archived pages</a></div><ol class="toc"> <li><div><a href="Hello.html">Hello, World</a></div></li> </ol></li><li class="generated"><div><a href="Contents+in+Depth.html">Contents in Depth</a></div></li><li class="generated"><div><a href="Combined+Pages.html">Combined Pages</a></div></li> </ol></div>
      </div>
      </div>
                </div><div class="col-md-8 col-xs-9">
                  <div class="rightcolumn contents">
                  <h3 id="sbt+1.0.0">sbt 1.0.0<a href="#sbt+1.0.0" class="header-link"><span class="header-link-content">&nbsp;</span></a></h3><h4 id="%E4%BA%92%E6%8F%9B%E6%80%A7%E3%81%AB%E5%BD%B1%E9%9F%BF%E3%81%AE%E3%81%82%E3%82%8B%E6%96%B0%E6%A9%9F%E8%83%BD%E3%80%81%E3%83%90%E3%82%B0%E4%BF%AE%E6%AD%A3%E3%80%81%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E5%A4%89%E6%9B%B4%E7%82%B9">互換性に影響のある新機能、バグ修正、その他の変更点<a href="#%E4%BA%92%E6%8F%9B%E6%80%A7%E3%81%AB%E5%BD%B1%E9%9F%BF%E3%81%AE%E3%81%82%E3%82%8B%E6%96%B0%E6%A9%9F%E8%83%BD%E3%80%81%E3%83%90%E3%82%B0%E4%BF%AE%E6%AD%A3%E3%80%81%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E5%A4%89%E6%9B%B4%E7%82%B9" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>移植に関しては <a href="../Migrating-from-sbt-013x.html">Migrating from sbt 0.13.x</a> も参照。
</p><ul><li>sbt 1.0 は、ビルド定義とプラグインに <strong>Scala 2.12 </strong> を使う。そのため、JDK 8 以上を必要とする。
</li><li>case class の多くは Contraband を用いて生成された疑似 case class に置き換えられた。<code>.copy(foo = xxx)</code> は <code>withFoo(xxx)</code> に書き換える必要がある。例えば、<code>UpdateConfiguration</code>、 <code>RetrieveConfiguration</code>、 <code>PublishConfiguration</code> などはビルダーパターンを使うようにリファクタリングした。
</li><li>Zinc 1 は、Scala 2.9 及びそれ以前のバージョンのサポートを打ち切る。Scala 2.10 は 2.10.2 以降、Scala 2.11 は 2.11.2 以降を使う必要がある。(最新のパッチ版を使うことを推奨する)
</li><li><code>config(&quot;xyz&quot;)</code> は、<code>val Xyz = config(&quot;xyz&quot;)</code> のように <strong>頭文字が大文字</strong>の <code>val</code> に直接代入する必要がある。これは左辺項の識別子を捕捉して後でシェルから使えるようにするためだ。
</li><li><code>publishTo</code> と <code>otherResolvers</code> は SettingKey から TaskKey へと変更した。<a href="https://github.com/sbt/sbt/issues/2059">#2059</a>/<a href="https://github.com/sbt/sbt/pull/2662">#2662</a> by <a href="https://github.com/dwijnand">@dwijnand</a>
</li><li><code>Path.relativizeFile(baseFile, file)</code> は <code>IO.relativizeFile(baseFile, file)</code> へと名前が変わった。
</li><li><code>PathFinder</code> の <code>.***</code> メソッドは <code>.allPaths</code> メソッドへと名前が変わった。
</li><li><code>PathFinder.x_!(mapper)</code> は <code>PathFinder</code> の <code>def pair</code> に変更された。
</li><li><code>sbt.Path</code> の多くのメソッド (<code>relativeTo</code>、<code>rebase</code>、 <code>flat</code> など) は以前は <code>sbt</code> のパッケージオブジェクト経由でデフォルトの名前空間に入っていたが、それが無くなったので <code>sbt.io.Path</code> を使ってアクセスしてほしい。
</li><li>sbt 1.0 は、スコープ成分としての <code>Global</code> を <code>Zero</code> と名前を変えて、<code>GlobalScope</code> と区別するようにした。 <a href="https://github.com/eed3si9n">@eed3si9n</a>
</li><li>今まで <code>update.value.configuration(...)</code> のような所でコンフィギュレーションを参照するのに文字列が使われていたのを、<code>ConfigRef</code> を使うように変更した。
</li><li><code>sourceArtifactTypes</code> と <code>docArtifactTypes</code> を <code>Set[String]</code> から <code>Seq[String]</code> セッティングへと変更した。
</li><li>early command 機能を <code>--&lt;command&gt;</code> という構文から <code>early(&lt;command&gt;)</code> へと変更した。
</li><li>sbt 0.12 スタイルのハイフン区切りされたキー名を撤廃した (例えば <code>publish-local</code> から <code>publishLocal</code> に移行する)。
</li><li>ログのオプションとして、<code>&quot;early(error)&quot;</code> などの代わりに <code>-error</code>、 <code>-warn</code>、 <code>-info</code>、 <code>-debug</code> オプションを追加した。
</li><li><code>sbt.Process</code> と <code>sbt.ProcessExtra</code> は撤廃した。<code>scala.sys.process</code> に移行する。
</li><li>name hashing が常に有効となったため、<code>incOptions.value.withNameHashing(...)</code> はオプションは無くなる。
</li><li><code>TestResult.Value</code> は <code>TestResult</code> に名前を変更する。
</li><li>Scripted プラグインはクロスバージョンされるため、使う場合は <code>%%</code> を使う必要がある。
</li></ul><p><strong>以前より廃止勧告が出ていて、今回撤廃されたもの</strong>:
</p><ul><li>sbt 0.12 スタイルの <code>Build</code> trait は sbt 0.13.12 に廃止勧告となり、この度削除した。<a href="Migrating-from-sbt-013x.html#Migrating+from+the+Build+trait">build.sbt へと移行</a>する必要がある。Auto plugin と <code>Build</code> trait は相性が悪く、またこの機能は既に普及しているマルチプロジェクト build.sbt によって置き換えられた。
</li><li>sbt 0.12 スタイルの <code>Project(...)</code> コンストラクタは、2つのパラメータを受け取るものだけに制限する。これは、<code>settings</code> パラメータは Auto plugin と相性が悪いからだ。代わりに、<code>project</code> を使ってほしい。
</li><li>sbt 0.12 スタイルのキー依存演算子 <code>&lt;&lt;=</code>, <code>&lt;+=</code>, <code>&lt;++=</code> は撤廃した。<a href="Migrating-from-sbt-013x.html#Migrating+simple+expressions">:=、 +=、および ++= 演算子へと移行</a>してほしい。古い演算子は多くのユーザにとって混乱の元となっており、長らく 0.13 のドキュメンテーションからは削除され、sbt 0.13.13 以降正式に撤廃勧告が出ていた。
</li><li>Auto plugin ではない <code>sbt.Plugin</code> を撤廃した。<code>AutoPlugin</code> へと移行してほしい。Auto plugin の方が設定が簡単で、プラグイン間の協調が可能だからだ。
</li><li><code>Project</code> より <code>settingsSet</code> メソッドおよび <code>add/setSbtFiles</code> を削除する。
</li><li>廃止勧告が出ていた <code>InputTask</code> <code>apply</code> メソッドと <code>inputTask</code> DSL メソッドを撤廃する。<code>Def.inputTask</code> と <code>Def.spaceDelimited().parsed</code> へと移行してほしい。
</li><li>廃止勧告が出ていた <code>ProjectReference</code> への暗黙の変換を撤廃する。<code>RootProject(&lt;uri&gt;)</code>、<code>RootProject(&lt;file&gt;)</code>、もしくは <code>LocalProject(&lt;string&gt;)</code> へと移行してほしい。
</li><li>廃止勧告が出ていた <code>seq(...)</code> DSL メソッドを撤廃する。<code>Seq(...)</code> を使うか、そのまま setting を渡すようにしてほしい。
</li><li>廃止勧告が出ていた <code>File</code>/<code>Seq[File]</code> セッティングの暗黙の変換を撤廃する。<code>.value</code> と <code>Def.setting</code> へと移行してほしい。
</li><li>廃止勧告が出ていた <code>SubProcess</code> の <code>apply</code> オーバーロードを撤廃する。<code>SubProcess(ForkOptions(runJVMOptions = ..))</code> へと移行する。
</li><li><code>toError(opt: Option[String]): Unit</code> を廃止する (<code>opt foreach sys.error</code> と同様)。<code>ScalaRun#run</code> と併用する場合、<code>scalaRun.run(...).failed foreach (sys error _.getMessage)</code> というように書き換える。
</li></ul><h3 id="%E6%96%B0%E6%A9%9F%E8%83%BD">新機能<a href="#%E6%96%B0%E6%A9%9F%E8%83%BD" class="header-link"><span class="header-link-content">&nbsp;</span></a></h3><ul><li>新しいインクリメンタル・コンパイラ Zinc 1。 (詳細は以下の項目)
</li><li>インタラクティブ・シェルにネットワーク API が追加された。(詳細は以下の項目)
</li><li>Library management API とアーティファクトの並列ダウンロード。(詳細は以下の項目)
</li><li>イベント・ロギング。(詳細は以下の項目)
</li><li>Scala Center がコントリビュートした <code>build.sbt</code> の静的バリデーション。(詳細は以下の項目)
</li><li>sbt-cross-building のプラグインのクロスビルド用の <code>^</code> と <code>^^</code> コマンドの移植。on projects that adopts Scalafmt
</li></ul><h3 id="%E6%94%B9%E5%96%84%E7%82%B9">改善点<a href="#%E6%94%B9%E5%96%84%E7%82%B9" class="header-link"><span class="header-link-content">&nbsp;</span></a></h3><ul><li>Scala Center は、Java フレンドリーな Zinc API をコントリビュートした。これは、他のビルドツールからも Scala を取り扱えるように Zinc の API を改善したものだ。 <a href="https://github.com/sbt/zinc/pull/304">zinc#304</a> by <a href="https://github.com/jvican">@jvican</a>
</li><li>Scala Center は、Zinc 内部の保存用のバイナリフォーマットをコントリビュートした。on projects that adopts Scalafmt
</li><li><code>scalas</code> を使ったときの、スタートアップのログレベルを <code>-error</code> まで落とした。 <a href="https://github.com/sbt/sbt/issues/840">#840</a> by <a href="https://github.com/eed3si9n">@eed3si9n</a>
</li><li>クロスビルドのサポートを sbt-doge に置き換えた。これによって、複数のプロジェクトを異なる Scala バージョンの組み合わせでクロスビルドする必要があるビルドを正しく扱うことができるようになった。<code>++</code> の振る舞いが変更され、Scala バージョンのサポートを予め列挙するサブプロジェクトのみが変更されるようになった。しかし、<code>!</code> を追加することで全てのプロジェクトを変更することもできる。どのプロジェクトが変更されたのかの詳細な情報を表示するための、<code>-v</code> オプションも追加された。<a href="https://github.com/sbt/sbt/pull/2613">#2613</a> by <a href="https://github.com/jroper">@jroper</a>
</li><li>CI 環境が検知された場合は、<code>ivyLoggingLevel</code> を <code>UpdateLogging.Quiet</code> に落とすようにした。 <a href="https://github.com/eed3si9n">@eed3si9n</a>
</li><li><code>build.sbt</code> (<code>*.sbt</code>) ファイル名をログに表示するようにした。 <a href="https://github.com/sbt/sbt/issues/1911">#1911</a> by <a href="https://github.com/valydia">@valydia</a>
</li><li>現在のプロジェクトに対して、<code>build.sbt</code> ファイルから <code>aggregate</code> を呼べるようにした。 By [@xuwei-k][@xuwei-k]
</li><li><code>inspect tree</code> などで表示される ASCII グラフの最大幅を決める <code>asciiGraphWidth</code> という新しいグローバルセッティングを追加した。デフォルトでは、40文字。By <a href="https://github.com/RomanIakovlev">@RomanIakovlev</a>.
</li><li><a href="www.scala-sbt.org/0.13/docs/Scopes.html">スコープ</a>のドキュメンテーションを刷新して、<a href="www.scala-sbt.org/0.13/docs/Scope-Delegation.html">スコープ委譲</a>のページを追加した。 <a href="https://github.com/eed3si9n">@eed3si9n</a>
</li><li>クロスバージョンを使ったライブラリの排除ができるようになった。 <a href="https://github.com/sbt/sbt/issues/1518">#1518</a>/<a href="https://github.com/sbt/librarymanagement/pull/88">lm#88</a> by <a href="https://github.com/jvican">@jvican</a>
</li><li>Ivy ベースのライブラリ管理に新しいオフラインモードを追加した。 <a href="https://github.com/sbt/librarymanagement/pull/92">lm#92</a> by <a href="https://github.com/jvican">@jvican</a>
</li><li>依存性ロッキングに関連するいくつかの機能が追加された。(詳細は以下の項目)
</li><li>Eviction 警告の表示の改善。(詳細は以下の項目)
</li><li>main class 検知の改善。 <a href="https://github.com/sbt/zinc/pull/287">zinc#287</a> by <a href="https://github.com/smarter">@smarter</a>
</li><li>より速いスタートアップのために、<code>autoImport</code> の検知に Java リフレクションを使うようにした。 <a href="https://github.com/sbt/sbt/pull/3115">#3115</a> by <a href="https://github.com/jvican">@jvican</a>
</li><li>より速いスタートアップのために、パーシングに同じコンパイラ Global のインスタンスを再利用するようにした。 <a href="https://github.com/sbt/sbt/pull/3115">#3115</a> by <a href="https://github.com/jvican">@jvican</a>
</li><li>sbt 0.13 との互換性維持のために、sbt-core-next から <code>InteractionService</code> を追加した。 <a href="https://github.com/sbt/sbt/pull/3182">#3182</a> by <a href="https://github.com/eed3si9n">@eed3si9n</a>
</li><li><code>PollingWatchService</code> と Java NIO を抽象化する新しい <code>WatchService</code> を追加した。 <a href="https://github.com/sbt/io/pull/47">io#47</a> by <a href="https://github.com/Duhemm">@Duhemm</a> on behalf of The Scala Center.
</li><li><code>IO.copyFile</code> と <code>IO.copyDirectory</code> に <code>sbt.io.CopyOptions()</code> を受け取るバリエーションを追加した。(詳細は以下の項目)
</li><li><code>Path.directory</code> と <code>Path.contentOf</code> を sbt-native-packager から寄付してもらった。 <a href="https://github.com/sbt/io/pull/38">io#38</a> by <a href="https://github.com/muuki88">@muuki88</a>
</li><li>Zinc のデバッグに使われる ApiDiff 機能を Dotty の Scala 実装のものから借りてきた。 <a href="https://github.com/sbt/zinc/pull/346">zinc#346</a> by <a href="https://github.com/Krever">@Krever</a>
</li><li>Zinc 内部で ExtractAPI が perRunCaches を使うようにした。 <a href="https://github.com/sbt/zinc/pull/347">zinc#347</a> by <a href="https://github.com/gheine">@gheine</a>
</li></ul><h4 id="%E5%86%85%E9%83%A8">内部<a href="#%E5%86%85%E9%83%A8" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><ul><li>ソースコードのフォーマットに Scalafmt を採用して、neo-sbt-scalafmt を用いる。
</li><li>Scala Center が Scripted test フレームワークがバッチ・モード実行できる再設計をコントリビュートした。これによって Scripted は同じ sbt インスタンスを再利用して sbt テストを実行でき、CI ビルド時間を 50% ダウンさせた。 <a href="https://github.com/sbt/sbt/pull/3151">#3151</a> by <a href="https://github.com/jvican">@jvican</a>
</li><li>sbt 1.0.0 は sbt 1.0.0-RC3 を用いてビルドされた。 <a href="https://github.com/sbt/sbt/pull/3184">#3184</a> by <a href="https://github.com/dwijnand">@dwijnand</a>
</li></ul><h3 id="%E5%A4%A7%E3%81%8D%E3%81%AA%E5%A4%89%E6%9B%B4%E3%81%AE%E8%A9%B3%E7%B4%B0%E7%82%B9">大きな変更の詳細点<a href="#%E5%A4%A7%E3%81%8D%E3%81%AA%E5%A4%89%E6%9B%B4%E3%81%AE%E8%A9%B3%E7%B4%B0%E7%82%B9" class="header-link"><span class="header-link-content">&nbsp;</span></a></h3><h3 id="Zinc+1%3A+%E3%82%AF%E3%83%A9%E3%82%B9%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE+name+hashing">Zinc 1: クラスベースの name hashing<a href="#Zinc+1%3A+%E3%82%AF%E3%83%A9%E3%82%B9%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE+name+hashing" class="header-link"><span class="header-link-content">&nbsp;</span></a></h3><p>(Lightbend の委託で) Grzegorz Kossakowski が Zinc 1 にもたらした大きな改善として、クラスベースの name hashing がある。これは、大規模な Scala プロジェクトにおいて差分コンパイルが高速化することが見込まれる。
</p><p>Zinc 1 の name hashing は、コード間の依存性をファイルではなく、クラスのレベルで追跡する。GitHub issue <a href="https://github.com/sbt/sbt/issues/1104">sbt/sbt#1104</a> に有名なプロジェクトの既存のクラスにメソッドを追加した場合の比較データがある:
</p><pre><code class="">ScalaTest   AndHaveWord class:          Before 49s, After 4s (12x)
Specs2      OptionResultMatcher class:  Before 48s, After 1s (48x)
scala/scala Platform class:             Before 59s, After 15s (3.9x)
scala/scala MatchCodeGen class:         Before 48s, After 17s (2.8x)
</code></pre><p>これは、クラスがどのようにまとめられているかといった様々な要素に依存するが、3x ~ 40x の向上が見られるのが分かる。高速化の理由は、クラスをソースファイルという「くくり」から分けたことで少ない数のソースファイルをコンパイルしているからだ。scala/scala の Platform クラスにメソッドを追加した例だと、sbt 0.13 の name hashing は 72 のソースをコンパイルしていたのに対し、新しい Zinc は 6 のソースをコンパイルしている。
</p><h4 id="Zinc+API+%E3%81%AE%E5%A4%89%E6%9B%B4">Zinc API の変更<a href="#Zinc+API+%E3%81%AE%E5%A4%89%E6%9B%B4" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><ul><li><code>xsbti.compile</code> パッケージ以下の <code>IncOptions</code> などの Java クラスはコンストラクタを隠蔽する。ファクトリーメソッドである <code>xsbti.compile.Foo.of(...)</code> に移行する。
</li><li><code>ivyScala: IvyScala</code> キーは <code>scalaModuleInfo: ScalaModuleInfo</code> に名前が変わる。
</li><li><code>xsbti.Reporter#log(...)</code> は <code>xsbti.Problem</code> をパラメータとして受け取るようになった。<code>log(problem.position, problem.message, problem.severity)</code> と呼び出すことで以前の <code>log(...)</code> に委譲できる。
</li><li><code>xsbi.Maybe</code>、<code>xsbti.F0</code>、<code>sxbti.F1</code> は対応する Java 8 クラスである <code>java.util.Optional</code>、<code>java.util.Supplier</code>、および <code>java.util.Function</code> に変更する。
</li><li>使われていなかった “resident” オプションを撤廃する。 <a href="https://github.com/sbt/zinc/pull/345">zinc#345</a> by <a href="https://github.com/lukeindykiewicz">@lukeindykiewicz</a>
</li></ul><h4 id="sbt+%E3%82%B5%E3%83%BC%E3%83%90%3A+%E3%83%84%E3%83%BC%E3%83%AA%E3%83%B3%E3%82%B0%E7%B5%B1%E5%90%88%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AE+JSON+API">sbt サーバ: ツーリング統合のための JSON API<a href="#sbt+%E3%82%B5%E3%83%BC%E3%83%90%3A+%E3%83%84%E3%83%BC%E3%83%AA%E3%83%B3%E3%82%B0%E7%B5%B1%E5%90%88%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AE+JSON+API" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>sbt 1.0 はサーバ機能を含み、IDE や他のツールは JSON API を用いてビルドのセッティングをクエリしたり、コマンドを呼び出すことができる。sbt 0.13 においてインタラクティブ・シェルが <code>shell</code> コマンドによって実装されていたのと同様に、「サーバ」も <code>shell</code> コマンドによって実装されていて、人間とネットワークの両方の入力を受け取るようになっている。ユーザ視点で見ると、サーバが加わったことによる影響はほとんど無いはずだ。
</p><p>2016年3月に「サーバ」機能が最小限になるように<a href="http://eed3si9n.com/ja/sbt-server-reboot">リブート</a>が行われた。JetBrain社で IntelliJ の sbt インターフェイスを担当する @jastice とコラボして機能のリストを絞っていった。sbt 1.0 の段階では当初欲しかった機能の全ては入っていないが、長期的に IDE と sbt エコシステムの連携が向上する布石になることを目指している。例えば、IDE 側から compile タスクを命令して、コンパイラ警告を JSON イベントして受け取るといったことができる:
</p><pre><code class="">{&quot;type&quot;:&quot;xsbti.Problem&quot;,&quot;message&quot;:{&quot;category&quot;:&quot;&quot;,&quot;severity&quot;:&quot;Warn&quot;,&quot;message&quot;:&quot;a pure expression does nothing in statement position; you may be omitting necessary parentheses&quot;,&quot;position&quot;:{&quot;line&quot;:2,&quot;lineContent&quot;:&quot;  1&quot;,&quot;offset&quot;:29,&quot;pointer&quot;:2,&quot;pointerSpace&quot;:&quot;  &quot;,&quot;sourcePath&quot;:&quot;/tmp/hello/Hello.scala&quot;,&quot;sourceFile&quot;:&quot;file:/tmp/hello/Hello.scala&quot;}},&quot;level&quot;:&quot;warn&quot;}
</code></pre><p>関連して追加された機能として、テスト中にバックグラウンドで web サーバなどを実行するのに使える <code>bgRun</code> タスクがある。
</p><h4 id="%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%83%BB%E3%83%AD%E3%82%AE%E3%83%B3%E3%82%B0">イベント・ロギング<a href="#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%83%BB%E3%83%AD%E3%82%AE%E3%83%B3%E3%82%B0" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>sbt 1.0 は、Log4J 2 と sjson-new を用いて実装したイベント・ロギングを導入する。
普通の String ベースのログの他に、logger に対して case clase や Contraband によって生成された疑似 case class を渡すことができる:
</p><pre><code>def registerStringCodec[A: ShowLines: TypeTag]: Unit = ...
final def debugEvent[A: JsonFormat: TypeTag](event: =&gt; A): Unit = logEvent(Level.Debug, event)
final def infoEvent[A: JsonFormat: TypeTag](event: =&gt; A): Unit = logEvent(Level.Info, event)
final def warnEvent[A: JsonFormat: TypeTag](event: =&gt; A): Unit = logEvent(Level.Warn, event)
final def errorEvent[A: JsonFormat: TypeTag](event: =&gt; A): Unit = logEvent(Level.Error, event)
</code></pre><p><code>[success]</code> メッセージといった様々なイベントは、内部でイベント・ロギングを用いて送信されている。
この機構をサーバと併用することで、プラグインやコンパイラから JSON イベントを発行することができる。
</p><p>また、Log4J 2 を内部に採用したことで SLF4J のバインディングを提供するようになった。
</p><h4 id="build.sbt+%E3%81%AE%E9%9D%99%E7%9A%84%E3%83%90%E3%83%AA%E3%83%87%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3">build.sbt の静的バリデーション<a href="#build.sbt+%E3%81%AE%E9%9D%99%E7%9A%84%E3%83%90%E3%83%AA%E3%83%87%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>sbt 1.0 は、タスク内において if 式の本文や匿名関数内からの <code>.value</code> の呼び出しを禁止する。<code>@sbtUnchecked</code> アノテーションを使ってこのチェックを無効化できる。
</p><p>他に、静的バリデーションは、タスクの本文内から <code>.value</code> を呼び忘れるのも予防する。
</p><p><a href="https://github.com/sbt/sbt/pull/3216">#3216</a> and <a href="https://github.com/sbt/sbt/pull/3225">#3225</a> by <a href="https://github.com/jvican">@jvican</a>
</p><h4 id="Eviction+%E8%AD%A6%E5%91%8A%E3%81%AE%E8%A1%A8%E7%A4%BA">Eviction 警告の表示<a href="#Eviction+%E8%AD%A6%E5%91%8A%E3%81%AE%E8%A1%A8%E7%A4%BA" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>sbt 1.0 は eviction 警告の表示を改善する。
</p><p>ビフォー:
</p><pre><code>[warn] There may be incompatibilities among your library dependencies.
[warn] Here are some of the libraries that were evicted:
[warn]  * com.google.code.findbugs:jsr305:2.0.1 -&gt; 3.0.0
[warn] Run 'evicted' to see detailed eviction warnings
</code></pre><p>アフター:
</p><pre><code>[warn] Found version conflict(s) in library dependencies; some are suspected to be binary incompatible:
[warn]
[warn]      * com.typesafe.akka:akka-actor_2.12:2.5.0 is selected over 2.4.17
[warn]          +- de.heikoseeberger:akka-log4j_2.12:1.4.0            (depends on 2.5.0)
[warn]          +- com.typesafe.akka:akka-parsing_2.12:10.0.6         (depends on 2.4.17)
[warn]          +- com.typesafe.akka:akka-stream_2.12:2.4.17 ()       (depends on 2.4.17)
[warn]
[warn] Run 'evicted' to see detailed eviction warnings
</code></pre><p><a href="https://github.com/sbt/sbt/pull/3202">#3202</a> by <a href="https://github.com/eed3si9n">@eed3si9n</a>
</p><h4 id="sbt-cross-building">sbt-cross-building<a href="#sbt-cross-building" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p><a href="https://github.com/jrudolph">@jrudolph</a> の sbt-cross-building はプラグイン作者のためのプラグインだ。
<code>^</code> (クロス) コマンドと <code>^^</code> (sbtVersion スイッチ) コマンドを追加して、これは <code>+</code> を <code>++</code> を sbt のメジャーバージョン間の切り替えに対応させたものだと考えることができる。
プラグインを sbt 1.0 に対応させるのに便利なので、sbt 0.13.16 においてこれらのコマンドを sbt 本体にマージした。
</p><p>シェルから <code>sbtVersion in pluginCrossBuild</code> をスイッチするには以下を実行する:
</p><pre><code class="">^^ 1.0.0
</code></pre><p>これで sbt 1.0.0 (とその Scala バージョンである 2.12) を使うようになる。
</p><p>sbt バージョンに特定のコードを含む必要があれば、<code>src/main/scala-sbt-0.13</code>、<code>src/main/scala-sbt-1.0</code> などバイナリ sbt バージョンを末尾に追加したディレクトリを作る。
</p><p>複数の sbt バージョンをまたいでコマンドを実行するには、まず:
</p><pre><code class="prettyprint lang-scala">crossSbtVersions := Vector(&quot;0.13.16&quot;, &quot;1.0.0&quot;)
</code></pre><p>と設定して、以下を実行する:
</p><pre><code class="">^ compile
</code></pre><p><a href="https://github.com/sbt/sbt/pull/3133">#3133</a> by <a href="https://github.com/eed3si9n">@eed3si9n</a> (forward ported from 0.13.16-M1)
</p><h4 id="CopyOptions">CopyOptions<a href="#CopyOptions" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>sbt IO 1.0 は <code>IO.copyFile</code> と <code>IO.copyDirectory</code> のバリエーションとして <code>sbt.io.CopyOptions()</code> を受け取るものを追加する。
<code>CopyOptions()</code> は疑似 case class の一例で、ビルダーパターンに似ている。
</p><pre><code class="prettyprint lang-scala">import sbt.io.{ IO, CopyOptions }

IO.copyDirectory(source, target)

// The above is same as the following
IO.copyDirectory(source, target, CopyOptions()
  .withOverwrite(false)
  .withPreserveLastModified(true)
  .withPreserveExecutable(true))
</code></pre><p><a href="https://github.com/sbt/io/pull/53">io#53</a> by <a href="https://github.com/dwijnand">@dwijnand</a>
</p><h4 id="Library+management+API+%E3%81%A8%E3%82%A2%E3%83%BC%E3%83%86%E3%82%A3%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%81%AE%E4%B8%A6%E5%88%97%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89">Library management API とアーティファクトの並列ダウンロード<a href="#Library+management+API+%E3%81%A8%E3%82%A2%E3%83%BC%E3%83%86%E3%82%A3%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%81%AE%E4%B8%A6%E5%88%97%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>sbt 1.0 は Lightbend社の Eugene Yokota (<a href="https://github.com/eed3si9n">@eed3si9n</a>) と Scala Center の Martin Duhem (<a href="https://github.com/Duhemm">@Duhemm</a>) 共著で書かれた Library management API を追加する。
この API は Apache Ivy および cached resolution や Coursier といったその他の代替依存性解決エンジンを抽象化することを目指している。
</p><p>Ivy エンジンのためのアーティファクトの並列ダウンロードは Scala Center の Jorge (<a href="https://github.com/jvican">@jvican</a>) によってコントリビュートされた。
また、これは Gigahorse OkHttp を Network API として導入し、内部で Square OkHttp をアーティファクトのダウンロードにも用いる。
</p><p><a href="https://github.com/sbt/librarymanagement/pull/124">lm#124</a> by <a href="https://github.com/eed3si9n">@eed3si9n</a>/<a href="https://github.com/Duhemm">@Duhemm</a>,
<a href="https://github.com/sbt/librarymanagement/pull/90">lm#90</a> by <a href="https://github.com/jvican">@jvican</a>/<a href="https://github.com/jsuereth">@jsuereth</a>
and <a href="https://github.com/sbt/librarymanagement/pull/104">lm#104</a> by <a href="https://github.com/eed3si9n">@eed3si9n</a>.
</p><h4 id="Zinc+%E3%81%AE%E5%86%85%E9%83%A8%E6%A7%8B%E9%80%A0%E4%BF%9D%E5%AD%98%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AE%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E5%BD%A2%E5%BC%8F">Zinc の内部構造保存のためのバイナリ形式<a href="#Zinc+%E3%81%AE%E5%86%85%E9%83%A8%E6%A7%8B%E9%80%A0%E4%BF%9D%E5%AD%98%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AE%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E5%BD%A2%E5%BC%8F" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>Zinc の内部構造の保存方法として Google Protocol Buffer を用いたバイナリ形式が Scala Center の Jorge (<a href="https://github.com/jvican">@jvican</a>) によってコントリビュートされた。この新形式は主に 3つの利点がある:
</p><ol><li>フォーマットレベルでの後方および前方互換性の向上。
</li><li>ファイルへのシリアライズ・デシリアライズの高速化 (1.5 ~ 2x)。
</li><li>ファイルのマシン非依存性の向上。
</li></ol><p><a href="https://github.com/sbt/zinc/pull/351">zinc#351</a> by <a href="https://github.com/jvican">@jvican</a>
</p><h4 id="%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E4%BE%9D%E5%AD%98%E6%80%A7%E3%81%AE%E3%83%AD%E3%83%83%E3%82%AD%E3%83%B3%E3%82%B0">ライブラリ依存性のロッキング<a href="#%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E4%BE%9D%E5%AD%98%E6%80%A7%E3%81%AE%E3%83%AD%E3%83%83%E3%82%AD%E3%83%B3%E3%82%B0" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>ライブラリ依存性のロッキング機能はまだ実装途中だが、Scala Center の Jorge (<a href="https://github.com/jvican">@jvican</a>) は関連する機能を追加して、最終的にロッキングが可能となる予定だ。
</p><ul><li>Ivy ベースのライブラリ管理に frozen モードを追加して、解決が全て intransitive であることを保証できるようにした。 <a href="https://github.com/sbt/librarymanagement/pull/100">lm#100</a>
</li><li>ライブラリごとにリゾルバを指定できるようにした。 <a href="https://github.com/sbt/librarymanagement/pull/97">lm#97</a>
</li><li>Ivy にチェックサムをスキップするように指示する “managed checksums” を追加した。 <a href="https://github.com/sbt/librarymanagement/pull/111">lm#111</a>
</li></ul><h4 id="%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AA%E3%83%93%E3%83%A5%E3%83%BC%E3%82%BF%E3%81%AE%E7%9A%86%E3%81%95%E3%82%93">コントリビュータの皆さん<a href="#%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AA%E3%83%93%E3%83%A5%E3%83%BC%E3%82%BF%E3%81%AE%E7%9A%86%E3%81%95%E3%82%93" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>感謝しなければいけない人が多すぎでここにおさまらなった。<a href="../Credits.html">Credits</a> を参照してほしい。
</p><div class="bottom nav">
                <div class="row">
                  <div class="col-md-auto">
                    <a href="Detailed-Topics.html">
                      <div class="arrowitem">
                        <span class="arrow">&gt;</span>
                      </div>

                      <div class="arrowitem">
                        <em>Next page</em><br/>
                        各論
                      </div>

                    </a>
                  </div>
                </div>
                <div class="row w-100">
        <div class="col-md-auto ml-auto">
          <ul class="language-bar">
            
          </ul>
        </div>
      </div>
              </div>
                  </div>
                </div>
          </div> <!-- row -->
        </div>
        <div class="header">
          <link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700,900,400italic,700italic" rel="stylesheet" type="text/css">
<div class="container-fluid top nav">
  <div class="row w-100">
    <div class="col-md-4">
      <div class="logo">
        <a href="../../../index.html"><img src="../files/sbt-logo.svg" alt="sbt"></a>
        <span class="versions"><select id="versions"></select></span>
      </div>
    </div>
    <div class="col-md-8">
      <div class="nav" id="topbar">
        <a href="../../../learn.html">Learn</a>
        <a href="../../../download.html">Download</a>
        <a href="../../../community.html">Get Involved</a>
        <a id="source-code" href="https://github.com/sbt/sbt"><img src="../files/github-logo-teal.svg" alt="Source code" class="social"></a>
        <a id="twitter" href="https://twitter.com/scala_sbt"><img src="../files/twitter-logo-teal.svg" alt="sbt on Twitter" class="social"></a>
        <a id="edit-on-github" href="https://github.com/sbt/website/edit/develop/src/reference/01-General-Info/Changes/47-sbt-1.0-Release-Notes.md"><img src="../files/octicon-pencil.svg" alt="Edit on GitHub"></a>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript" async>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-41449189-1', 'scala-sbt.org');
ga('send', 'pageview');
</script>
<script type="text/javascript" async>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-23127719-1', 'lightbend.com', {'allowLinker': true, 'name': 'tsTracker'});
  ga('tsTracker.require', 'linker');
  ga('tsTracker.linker:autoLink', ['lightbend.com','playframework.com','scala-lang.org','scaladays.org','spray.io','akka.io','scala-sbt.org']);
  ga('tsTracker.send', 'pageview');
</script>
<script type="text/javascript">
$(function() {
var scrollDown = function() {
if (window.location.hash !== "") {
  setTimeout(function() { $(window).scrollTop($(window).scrollTop() - 120); }, 100);
}
}
scrollDown();
$(window).bind('hashchange', function() {
scrollDown();
});
});
</script>

        </div>
        <div class="footer">
          <footer>
  <div class="container-fluid footer">
    <div class="row">
      <div class="col-md-8">
        <div class="support-item">
          <div class="support-icon">
            <svg class="svg-icon svg-icon-chat" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 97.5 85.2" enable-background="new 0 0 97.5 85.2"><path stroke="#fff" stroke-width="4.282" stroke-linecap="round" stroke-miterlimit="10" d="M27 29.5h-16.3c-4.7 0-8.6 3.9-8.6 8.6v25.7c0 4.7 3.9 8.6 8.6 8.6h2.7c.8 0 1.5.7 1.5 1.5v7.8c0 1.3 1.6 2 2.5 1l9.5-9.5c.5-.5 1.2-.8 2-.8h20.2c4.7 0 8.6-3.9 8.6-8.6v-7.8" fill="none"/><path fill="#fff" d="M85 0h-40c-6.9 0-12.5 5.6-12.5 12.5v33.4c0 2.2 1.8 4.1 4.1 4.1h29.9c.7 0 1.3.3 1.8.7l10 10c1.6 1.6 4.3.5 4.3-1.8v-6.5c0-1.4 1.1-2.5 2.5-2.5 6.9 0 12.5-5.6 12.5-12.5v-25c-.1-6.8-5.8-12.4-12.6-12.4z"/></svg>
          </div>
          <div class="support-detail">
            <h2>コミュニティー・サポート</h2>
            <a href="https://stackoverflow.com/questions/tagged/sbt">StackOverflow</a>
          </div>
        </div>
        <div class="support-item">
          <div class="support-icon">
            <svg id="lightbend-icon-reverse" class="svg-icon svg-icon-lightbend-reverse" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 302 262"><title>lightbend-icon</title><g id="icon"><path d="M1,195v56a10,10,0,0,0,10,10H291a10,10,0,0,0,10-10V195a557.85,557.85,0,0,1-150,20A557.85,557.85,0,0,1,1,195Z" style="fill:#fff"/><path d="M291,1H11A10,10,0,0,0,1,11V176a539.94,539.94,0,0,0,150,21,539.94,539.94,0,0,0,150-21V11A10,10,0,0,0,291,1Z" style="fill:#fff"/></g></svg>
          </div>
          <div class="support-detail">
            <h2>商用サポート</h2>
            <a href="https://www.lightbend.com/services/expert-support">Lightbend Subscription</a>
            <a href="https://www.lightbend.com/services/training">Training</a>
            <a href="https://www.lightbend.com/services/consulting">Consulting</a>
          </div>
        </div>
      </div>
      <div class="col-md-4 text-right ts">
        &copy; 2016-<script>document.write(new Date().getFullYear())</script>Lightbend Inc.
        <a href="https://www.lightbend.com">
          <img src="../files/lightbend-reverse.svg" alt="Lightbend, Inc.">
        </a>
      </div>
    </div>
  </div>
</footer><script src="/assets/versions.js"></script><script src="/assets/set-versions.js"></script>
        </div>
        
        <div class="highlight-outer">
              <div class="highlight-menu">
                <ul>
                  <li><button id="highlight-button-twitter"><img src="../img/twitter-bird-dark-bgs.png"/></button></li>
                </ul>
              </div>
            </div>
      </body>
    </html>